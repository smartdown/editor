"use strict";(globalThis["webpackChunksmartdown_editor"]=globalThis["webpackChunksmartdown_editor"]||[]).push([[866],{6051:(t,e,o)=>{o.d(e,{Z:()=>r});var a=o(59835);const n={class:"q-mr-auto q-ml-auto"};function i(t,e){return(0,a.wg)(),(0,a.iD)("div",n,[(0,a.WI)(t.$slots,"default")])}var s=o(11639);const d={},l=(0,s.Z)(d,[["render",i]]),r=l},27866:(t,e,o)=>{o.r(e),o.d(e,{default:()=>j});var a=o(59835);const n={key:0,ref:"noteDiv"},i={key:0},s={key:1};function d(t,e,o,d,l,r){const u=(0,a.up)("Editor"),c=(0,a.up)("SourceEditor"),m=(0,a.up)("smartdown"),p=(0,a.up)("Container"),v=(0,a.up)("q-page");return(0,a.wg)(),(0,a.j4)(v,null,{default:(0,a.w5)((()=>[(0,a.Wm)(p,null,{default:(0,a.w5)((()=>[d.note?((0,a.wg)(),(0,a.iD)("div",n,[d.editMode.editing?((0,a.wg)(),(0,a.iD)("div",i,[d.editMode.source?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(u,{key:0,class:"full-width edit-border",modelValue:d.note.content,"onUpdate:modelValue":e[0]||(e[0]=t=>d.note.content=t),focused:d.focus},null,8,["modelValue","focused"])),d.editMode.source?((0,a.wg)(),(0,a.j4)(c,{key:1,class:"full-width edit-border",modelValue:d.note.content,"onUpdate:modelValue":e[1]||(e[1]=t=>d.note.content=t),focused:d.focus},null,8,["modelValue","focused"])):(0,a.kq)("",!0)])):(0,a.kq)("",!0),d.editMode.editing?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",s,[(0,a.Wm)(m,{class:"q-mt-md q-pa-sm readonly-border",initInput:d.note.content},null,8,["initInput"])]))],512)):(0,a.kq)("",!0)])),_:1})])),_:1})}var l=o(60499),r=o(20367);const u={ref:"editor",class:"editor"};function c(t,e,o,n,i,s){return(0,a.wg)(),(0,a.iD)("div",u,null,512)}var m=o(12343),p=o(33673),v=o(25315),h=o(50178);o(25465);const w=t=>{const e=(0,h.Nr)({schema:v.fK});return m.yy.create({doc:v.EU.parse(t),plugins:e})};function g(t){const e=t.replaceAll("\\\\","\\");return e}const f={name:"Editor",props:["modelValue","focused"],data(){return{lastValue:null}},created(){this.state=w(this.modelValue)},mounted(){this.view=new p.tk(this.$refs.editor,{state:this.state,dispatchTransaction:t=>{this.state=this.state.apply(t),this.view&&this.view.updateState(this.state),this.lastValue=v.Dm.serialize(this.state.doc),this.lastValue=g(this.lastValue),this.$emit("update:modelValue",this.lastValue)}}),this.view.focus()},watch:{focused(t){t&&this.view.focus()},modelValue(t){t!==this.lastValue&&(this.state=w(t),this.view.updateState(this.state))}}};var y=o(11639);const S=(0,y.Z)(f,[["render",c]]),V=S;var b=o(6051);const k=(0,a._)("div",{id:"smartdown-outer-container",class:"smartdown-outer-container smartdown-theme-chat"},[(0,a._)("div",{class:"smartdown-container",id:"smartdown-output"})],-1),E=[k];function M(t,e,o,n,i,s){return(0,a.wg)(),(0,a.iD)("div",null,E)}const D={props:{title:String,initInput:String},setup(t){const e=(0,l.iH)(""),o=(0,l.iH)(t.initInput);async function n(t){const e=new Promise((e=>{const o=document.createElement("div");smartdown.setSmartdown(t,o,(()=>{const t=o.innerHTML;e(t)}))}));return e}return(0,a.YP)(SQ.cardToLoad,(async()=>{if(console.log("watch(SQ.cardToLoad",SQ.cardToLoad),SQ.cardToLoad.value){const t=`gallery/${SQ.cardToLoad.value}.md`;console.log("cardPath",t),o.value=await(await fetch(t)).text(),e.value=await n(o.value),await(0,a.Y3)();const i=document.getElementById("smartdown-output");smartdown.setHome(o.value,i,(async()=>{smartdown.startAutoplay(i)}))}})),(0,a.bv)((async()=>{e.value=await n(o.value),await(0,a.Y3)();const t=document.getElementById("smartdown-output");smartdown.setHome(o.value,t,(async()=>{smartdown.startAutoplay(t)}))})),{markdown:o,html:e}}},T=(0,y.Z)(D,[["render",M]]),q=T;function Q(t,e,o,n,i,s){const d=(0,a.up)("MonacoEditor");return(0,a.wg)(),(0,a.j4)(d,{theme:"hc-black",options:i.options,language:"markdown",width:800,height:800,diffEditor:!1,original:i.original,value:i.value,"onUpdate:value":e[0]||(e[0]=t=>i.value=t),onEditorDidMount:s.editorDidMount},null,8,["options","original","value","onEditorDidMount"])}var Z=o(42958);const H={name:"SourceEditor",props:["modelValue","focused"],data(){return{value:"",original:"",options:{minimap:{enabled:!1},wordWrap:!0,colorDecorators:!0,tabSize:2,automaticLayout:!0,useTabStops:!0,renderWhitespace:!1,stickyTabStops:!1,insertSpaces:!0,formattingOptions:{tabSize:2,insertSpaces:!0}}}},components:{MonacoEditor:Z.Z},created(){this.value=this.modelValue,this.original=this.modelValue},watch:{modelValue(t){this.value=t}},methods:{editorDidMount(t){const e=t.getModel(),o=this.options.formattingOptions;e.updateOptions(o),window.editor=t,t.onDidChangeModelContent((()=>{this.$emit("update:modelValue",this.value)}))}}},I=(0,y.Z)(H,[["render",Q]]),L=I,C={components:{Container:b.Z,Editor:V,Smartdown:q,SourceEditor:L},setup(){const t=(0,l.iH)(null),e=(0,l.iH)(!0),o=(0,r.o)(),n=(0,a.Fl)({get:()=>o.getNote.value}),i=(0,a.Fl)({get:()=>o.getEditMode.value,set:o.updateEditMode});(0,a.wF)((()=>{e.value=i.value.editing&&!i.value.detailed}));let s=i.value.source;return(0,a.YP)(i,(()=>{const o=t.value;o.scroll({top:0,left:0,behavior:"smooth"}),i.value.source&&!s&&(i.value.editing=!0),s=i.value.source,i.value.editing&&(SQ.setToolbarVisibility(!0),SQ.setToolbarTransparency(!1),SQ.setToolbarFade(!1)),e.value=i.value.editing&&!i.value.detailed}),{deep:!0}),{noteDiv:t,note:n,editMode:i,focus:e}}};var _=o(69885),F=o(18149),P=o(69984),W=o.n(P);const $=(0,y.Z)(C,[["render",d]]),j=$;W()(C,"components",{QPage:_.Z,QField:F.Z})}}]);